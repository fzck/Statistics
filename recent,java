
package auzau105;

import java.util.*;

/**
 *
 * @author ADMIN
 * TODO documentation
 */
public class AuZau105 {

    public static int N, n;
    public static double percentage;
    public static void main(String[] args) {
        // TODO code application logic here
        
        
        Scanner sc = new Scanner(System.in);
        int choice = 0;
        do{
            System.out.println("Basic Sampling Methods");
            System.out.println();
            System.out.println("[1] SIMPLE RANDOM SAMPLING");
            System.out.println("[2] SYSTEMATIC SAMPLING");
            System.out.println("[3] STRATIFIED SAMPLING");
            System.out.println("[4] EXIT");
            System.out.println();
            System.out.println("Pick a number and press enter");
            choice = sc.nextInt();  
            
            if(choice == 1){            
                System.out.println(" SIMPLE RANDOM SAMPLING");
                int type = 0;
                do{
                    System.out.println("Pick your input type: [1]Integer [2]Character");                    
                    type = sc.nextInt();
                }while (type < 1 || type > 2);
                
                if (type == 1){
                    SRS();
                } else {
                    SRS2();
                }
                
                
            }
            
            else if (choice == 2){
                System.out.println(" SYSTEMATIC SAMPLING");
                int type2 = 0;
                do{
                    System.out.println("Pick your input type: [1]Integer [2]Character");                    
                    type2 = sc.nextInt();
                }while(type2 < 1 || type2 > 2);
                
                if (type2 == 1){
                    Systematic();
                } else {
                    Systematic2();
                }
                
            }
            
            else if(choice == 3){
                System.out.println(" STRATIFIED SAMPLING");
                ArrayList al = new ArrayList<>();
                ArrayList<ArrayList> all;
                al = GetData3();
                all = Stratified(al);
                System.out.println(all);
            }
            else if (choice > 4 || choice < 4){
                System.out.println("INVALID INPUT");
            }
        
           
        }while(choice != 4);
        
        System.out.println("[4] EXIT");               
        System.exit(0);
               
    }
    
    public static ArrayList<Integer> GetData(){
        N = 0;
        n = 0;
        ArrayList<Integer> list = new ArrayList<>();
        
        Scanner sc = new Scanner(System.in);
        do{
            System.out.println("ENTER THE POPULATION SIZE: ");
            N = sc.nextInt();
        }while(N < 1);
        
        System.out.println("ENTER MEMBERS OF SAMPLING FRAME: ");
        sc.nextLine();
        for(int i = 1; i <= N; i++){
            System.out.print("["+i+"]" +" ");
            int member = sc.nextInt();
            list.add(member);    
            
        }
        //displayed to verify if inputs match
        System.out.println("THIS IS THE SAMPLING FRAME: ");
        System.out.println(list);
        
        int sampleOption = 0;
        do{
            System.out.println("SAMPLE SIZE OPTIONS:[1]DEFAULT [2]USER INPUT");
            sampleOption = sc.nextInt();
        } while (sampleOption < 1 || sampleOption > 2);
        
        
        if (sampleOption == 1){
            double sampleSize = (double) N * .2;
            Math.ceil(sampleSize);
            n = (int) sampleSize;
            System.out.println("samplesize == "+n);
        } else {
            do{ 
                System.out.println("ENTER THE SAMPLE SIZE: ");
                n = sc.nextInt();            
            } while(n < 1 || n >= N);
        }
        
        
        
        return list;
    }
    
    
    
        public static ArrayList<Character> GetDataChar(){
        N = 0;
        n = 0;
        ArrayList<Character> list = new ArrayList<>();
        
        Scanner sc = new Scanner(System.in);
        do{
            System.out.println("ENTER THE POPULATION: ");
            N = sc.nextInt();
        }while(N <= 1);
        
        System.out.println("ENTER MEMBERS OF SAMPLING FRAME: ");
        sc.nextLine();
        for(int i = 1; i <= N; i++){
            System.out.print("["+i+"]" +" ");
            //to consume strictly one character
            char member = sc.next(".").charAt(0);
            if(member >= 'A' || member <= 'Z'){
            member = Character.toLowerCase(member);
            }
            list.add(member);    
            
        }
        //displayed to verify if inputs match
        System.out.println("THIS IS THE SAMPLING FRAME: ");
        System.out.println(list);
        
        int sampleOption = 0;
        do{
            System.out.println("SAMPLE SIZE OPTIONS:[1]DEFAULT [2]USER INPUT");
            sampleOption = sc.nextInt();
        } while (sampleOption < 1 || sampleOption > 2);
        
        
        if (sampleOption == 1){
            double sampleSize = (double) N * .2;
            Math.ceil(sampleSize);
            n = (int) sampleSize;
            System.out.println("samplesize == "+n);
        } else {
            do{ 
                System.out.println("ENTER THE SAMPLE SIZE: ");
                n = sc.nextInt();            
            } while(n < 1 || n >= N);
        }
        
        
        
        return list;
    }
        
    public static ArrayList GetData3(){
        N = 0;
        n = 0;
        ArrayList list = new ArrayList<>();
        
        Scanner sc = new Scanner(System.in);
        do{
            System.out.println("ENTER THE POPULATION SIZE: ");
            N = sc.nextInt();
        }while(N <= 1);
        
        System.out.println("ENTER MEMBERS OF SAMPLING FRAME: ");
        sc.nextLine();
        for(int i = 1; i <= N; i++){
            System.out.print("["+i+"]" +" ");
            int member = sc.nextInt();
            list.add(member);    
            
        }
        //displayed to verify if inputs match
        System.out.println("THIS IS THE SAMPLING FRAME: ");
        System.out.println(list);
        
        
        int sampleOption = 0;
        do{
            System.out.println("SAMPLE SIZE OPTIONS:[1]DEFAULT [2]USER INPUT");
            sampleOption = sc.nextInt();
        } while (sampleOption < 1 || sampleOption > 2);
        
        
        if (sampleOption == 1){
            double sampleSize = (double) N * .2;
            Math.ceil(sampleSize);
            n = (int) sampleSize;
            System.out.println("samplesize == "+n);
        } else {
            do{ 
                System.out.println("ENTER THE SAMPLE SIZE PERCENTAGE: ");
                percentage = (sc.nextDouble())*.01;
                double sampleSize = (double) N * percentage;
                Math.ceil(sampleSize);
                n = (int) sampleSize;
                System.out.println("samplesize == "+n);          
            } while(n < 1 || n >= N);
        }
        
        
        
        return list;
    }
    
    public static void SRS(){
        
        
       
       ArrayList<Integer> sampleframe = GetData();
       ArrayList<Integer> samples = new ArrayList<>();
       ArrayList<Integer> chosenIndex = new ArrayList<>(n);
       System.out.println(sampleframe);
       
       //System.out.println(n);        
       Random rand = new Random();
       Integer r;
       
       //System.out.println(r);
       
       int chosen = 0;
       for (int i = 0; i < n; i++){  
            r = rand.nextInt(N);
            
            chosenIndex.add(r);
            
            while (samples.size() != n){
                if(!chosenIndex.contains(r) && !samples.contains(sampleframe.get(r))){
                    
                    chosen = sampleframe.get(r);
                    System.out.println(chosen+ " ["+r+"]");
                    samples.add(chosen);
                } else {
                    r = rand.nextInt(N);
                }
            }
               //System.out.println(chosen);
       }
       
      
       System.out.println(sampleframe);
       
       System.out.println(sampleframe);  
       System.out.println(samples); 
    }
    
    
    public static void SRS2(){
             
       ArrayList<Character> sampleframe = GetDataChar();
       ArrayList<Character> samples = new ArrayList<>();
       ArrayList<Integer> chosenIndex = new ArrayList<>(n);
       System.out.println(sampleframe);
       
       //System.out.println(n);        
       Random rand = new Random();
       Integer r;
       
       //System.out.println(r);
       
       char chosen;
       for (int i = 0; i < n; i++){  
            r = rand.nextInt(N);
            
            chosenIndex.add(r);
            
            while (samples.size() != n){
                if(!chosenIndex.contains(r) && !samples.contains(sampleframe.get(r))){
                    System.out.println("r "+r);
                    chosen = sampleframe.get(r);
                    samples.add(chosen);
                } else {
                    r = rand.nextInt(N);
                }
            }
               //System.out.println(chosen);
       }
       
       System.out.println(sampleframe);  
       System.out.println(samples); 
    }
    
    
    public static void Systematic(){
        
        ArrayList<Integer> sampleframe = GetData();
        ArrayList<Integer> samples = new ArrayList<>();

        Random rand = new Random();

        int k = N/n;

        int it = rand.nextInt(k);

        for(int i=1,c=it; i<=n;i++,c+=k ){
            samples.add(sampleframe.get(c));
        }

        System.out.println(samples); 
     
    }
    
     public static void Systematic2(){
        
        ArrayList<Character> sampleframe = GetDataChar();
        ArrayList<Character> samples = new ArrayList<>();

        Random rand = new Random();

        int k = N/n;

        int it = rand.nextInt(k);

        for(int i=1,c=it; i<=n;i++,c+=k ){
            samples.add(sampleframe.get(c));
        }

        System.out.println(samples); 
     
    }
     
       public static ArrayList SRSforStratum(ArrayList al){
               
       ArrayList samples = new ArrayList<>();
       ArrayList<Integer> chosenIndex = new ArrayList<>();
      
       
       //System.out.println(n);        
       Random rand = new Random();
       Integer r;
       
       //System.out.println(r);
       
       int chosen = 0, sizeOfList = (int) Math.ceil(percentage)*al.size();
       for (int i = 0; i < al.size(); i++){  
            r = rand.nextInt(al.size());
            
            chosenIndex.add(r);
            
            while (samples.size() != sizeOfList ){
                if(!chosenIndex.contains(r) && !samples.contains(al.get(r))){
                    System.out.println("r "+r);
                    chosen = (int)al.get(r);
                    samples.add(chosen);
                } else {
                    r = rand.nextInt(N);
                }
            }
               //System.out.println(chosen);
       }        
       System.out.println("SAMPLES NI"+samples+">>>"); 
       return samples;
    }     
    
    public static ArrayList<ArrayList> Stratified (ArrayList al){ 
    
        Collections.sort(al);
        ArrayList< ArrayList > alal = new ArrayList<>();
        
        boolean[] visited = new boolean[al.size()];

        for(int i = 0; i < al.size(); i++){
            Boolean el = visited[i];
            if( !el ){
                Object obj1 = al.get(i);
                alal.add( new ArrayList() );
                ArrayList curr = alal.get(alal.size() - 1);
                curr.add( obj1 );

                for(int j = i+1; j < al.size(); j++){
                    Object obj2 = al.get(j);
                    if(obj2.equals(obj1)){
                        visited[j] = true;
                        curr.add( obj2 );
                    }
                }
            }
        }
        ArrayList extract = new ArrayList<>();
        for(int i = 0; i < alal.size(); i++)  {
        System.out.println("Stratum["+i+"]: "+alal.get(i));
        extract = alal.get(i);
        SRSforStratum(extract);
      }
          
      
      
      return alal;  
      
    }
    
   
        
    }
